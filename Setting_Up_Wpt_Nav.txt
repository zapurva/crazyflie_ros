Setting up waypoint navigation with some changes from Hoenig's version
